# æ®µè½ç¼–è¾‘å®Œæ•´è§„èŒƒ

> **å‚è€ƒæ ‡å‡†**: Craftã€é£ä¹¦æ–‡æ¡£ã€Notion  
> **æ›´æ–°æ—¥æœŸ**: 2025-11-29

---

## ğŸ“‹ ç›®å½•

1. [æ®µè½çŠ¶æ€è®¾è®¡](#æ®µè½çŠ¶æ€è®¾è®¡)
2. [è¾¹æ¡†ä¸è§†è§‰åé¦ˆ](#è¾¹æ¡†ä¸è§†è§‰åé¦ˆ)
3. [å ä½ç¬¦ç³»ç»Ÿ](#å ä½ç¬¦ç³»ç»Ÿ)
4. [å¿«æ·é”®ç³»ç»Ÿ](#å¿«æ·é”®ç³»ç»Ÿ)
5. [äº¤äº’è¡Œä¸º](#äº¤äº’è¡Œä¸º)
6. [å®Œæ•´å®ç°ä»£ç ](#å®Œæ•´å®ç°ä»£ç )

---

## æ®µè½çŠ¶æ€è®¾è®¡

### 1.1 ç©ºæ®µè½çŠ¶æ€ï¼ˆEmpty Stateï¼‰

#### è§†è§‰è§„èŒƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–±ï¸ è¾“å…¥ '/' æ‰“å¼€å‘½ä»¤èœå•...             â”‚ â† å ä½ç¬¦æ–‡æœ¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å†…è¾¹è·: padding: 8px 2px
æœ€å°é«˜åº¦: min-height: 32px ï¼ˆç¡®ä¿å¯ç‚¹å‡»ï¼‰
å ä½ç¬¦é¢œè‰²: color: #9CA3AF
å ä½ç¬¦å­—å·: font-size: 15px ï¼ˆæ¯”æ­£æ–‡å°1pxï¼‰
å ä½ç¬¦æ ·å¼: font-style: normal, opacity: 0.6
```

#### Craft çš„å¤„ç†æ–¹å¼
- **å ä½ç¬¦**: "Type '/' for commands"
- **é¢œè‰²**: éå¸¸æµ…çš„ç°è‰²ï¼ˆ#B8B8B8ï¼‰
- **åŠ¨ç”»**: å ä½ç¬¦åœ¨è·å¾—ç„¦ç‚¹æ—¶æ·¡å‡ºï¼ˆ150msï¼‰
- **ç‰¹è‰²**: æ”¯æŒå¤šç§å ä½ç¬¦æ¨¡æ¿ï¼ˆå¯è‡ªå®šä¹‰ï¼‰

#### é£ä¹¦çš„å¤„ç†æ–¹å¼
- **å ä½ç¬¦**: "è¾“å…¥æ–‡å­—" / "æŒ‰ä¸‹ '/' æ’å…¥å—"
- **é¢œè‰²**: ä¸­ç­‰ç°è‰²ï¼ˆ#8F959Eï¼‰
- **ä½ç½®**: å·¦å¯¹é½ï¼Œä¸æ­£æ–‡å¯¹é½
- **ç‰¹è‰²**: å¯ä»¥è®¾ç½®æ®µè½æç¤ºæ¨¡æ¿

#### Notion çš„å¤„ç†æ–¹å¼
- **å ä½ç¬¦**: "Press 'space' for AI, '/' for commands..."
- **é¢œè‰²**: æµ…ç°è‰²ï¼ˆ#CFCFCFï¼‰
- **ç‰¹è‰²**: AI é›†æˆæç¤º
- **è¡Œä¸º**: ç„¦ç‚¹æ—¶ä¿æŒæ˜¾ç¤ºï¼Œè¾“å…¥æ—¶æ¶ˆå¤±

---

### 1.2 æœ‰å†…å®¹çŠ¶æ€ï¼ˆFilled Stateï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–±ï¸ è¿™æ˜¯ä¸€æ®µå·²è¾“å…¥çš„æ–‡æœ¬å†…å®¹ï¼Œæ”¯æŒå¤šè¡Œ   â”‚
â”‚    æ˜¾ç¤ºå’Œè‡ªåŠ¨æ¢è¡ŒåŠŸèƒ½ã€‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å†…è¾¹è·: padding: 3px 2px
è¡Œé«˜: line-height: 1.6
å­—å·: font-size: 16px
é¢œè‰²: color: #37352F (Notion) / #1F2329 (é£ä¹¦)
```

---

## è¾¹æ¡†ä¸è§†è§‰åé¦ˆ

### 2.1 é»˜è®¤çŠ¶æ€ï¼ˆDefaultï¼‰

**Craft è®¾è®¡**:
```css
border: none;
background: transparent;
transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
```

**é£ä¹¦è®¾è®¡**:
```css
border: 1px solid transparent;
background: transparent;
border-radius: 2px;
```

**Notion è®¾è®¡**:
```css
border: none;
background: transparent;
box-shadow: none;
```

**å…±åŒç‰¹ç‚¹**: é»˜è®¤çŠ¶æ€å‡ ä¹ä¸å¯è§ï¼Œæç®€ä¸»ä¹‰

---

### 2.2 æ‚¬åœçŠ¶æ€ï¼ˆHoverï¼‰

**Craft è®¾è®¡**:
```css
/* æ‚¬åœæ—¶æ˜¾ç¤ºå·¦ä¾§æ‰‹æŸ„ */
.paragraph:hover .drag-handle {
  opacity: 1;
  transform: translateX(0);
}

/* æ®µè½èƒŒæ™¯å˜åŒ– */
.paragraph:hover {
  background: rgba(55, 53, 47, 0.03); /* éå¸¸æµ… */
  border-radius: 3px;
  cursor: text;
}
```

**é£ä¹¦è®¾è®¡**:
```css
.paragraph:hover {
  background: rgba(31, 35, 41, 0.04);
  border-radius: 4px;
}

/* å·¦ä¾§å‡ºç°æ‹–æ‹½æ‰‹æŸ„å’Œèœå• */
.block-handle:hover {
  visibility: visible;
  opacity: 1;
}
```

**Notion è®¾è®¡**:
```css
.notion-block:hover {
  background: rgba(55, 53, 47, 0.08);
  border-radius: 3px;
}

/* å·¦ä¾§6ç‚¹æ‰‹æŸ„ */
.block-handle {
  position: absolute;
  left: -24px;
  opacity: 0;
  transition: opacity 200ms;
}

.notion-block:hover .block-handle {
  opacity: 1;
}
```

**å…³é”®å·®å¼‚**:
- **Craft**: æœ€æµ…çš„èƒŒæ™¯è‰²ï¼Œå¼ºè°ƒç®€æ´
- **é£ä¹¦**: ä¸­ç­‰èƒŒæ™¯è‰²ï¼Œæ‰‹æŸ„ + èœå•æŒ‰é’®
- **Notion**: è¾ƒæ·±èƒŒæ™¯è‰²ï¼Œæ ‡å¿—æ€§6ç‚¹æ‰‹æŸ„

---

### 2.3 ç„¦ç‚¹çŠ¶æ€ï¼ˆFocusï¼‰

**Craft è®¾è®¡**:
```css
.paragraph:focus-within {
  background: transparent;  /* ç„¦ç‚¹æ—¶ç§»é™¤èƒŒæ™¯ */
  outline: none;
}

/* ä½¿ç”¨è™šæ‹Ÿè¾¹æ¡†ï¼ˆä¼ªå…ƒç´ ï¼‰*/
.paragraph:focus-within::before {
  content: '';
  position: absolute;
  left: -2px;
  top: 0;
  bottom: 0;
  width: 2px;
  background: #007AFF;  /* iOSè“ */
  border-radius: 1px;
  opacity: 0.8;
}
```

**é£ä¹¦è®¾è®¡**:
```css
.paragraph:focus-within {
  background: rgba(31, 35, 41, 0.02);
  border: 1px solid rgba(31, 136, 229, 0.3);
  border-radius: 4px;
  box-shadow: 0 0 0 2px rgba(31, 136, 229, 0.1);
}

/* è“è‰²å¤–å‘å…‰æ•ˆæœ */
```

**Notion è®¾è®¡**:
```css
.notion-block:focus-within {
  background: transparent;
  outline: none;
}

/* å·¦ä¾§è“è‰²è¾¹æ¡† */
.notion-block:focus-within::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: rgb(35, 131, 226);
  border-radius: 1.5px;
}
```

**è®¾è®¡æ¨¡å¼å¯¹æ¯”**:

| äº§å“ | è¾¹æ¡†ä½ç½® | é¢œè‰² | å®½åº¦ | ç‰¹æ®Šæ•ˆæœ |
|------|---------|------|------|---------|
| Craft | å·¦ä¾§ | #007AFF | 2px | æ—  |
| é£ä¹¦ | å››å‘¨ | #1F88E5 | 1px | å¤–å‘å…‰ |
| Notion | å·¦ä¾§ | #2383E2 | 3px | æ—  |

---

### 2.4 é€‰ä¸­çŠ¶æ€ï¼ˆSelectedï¼‰

**Craft è®¾è®¡**:
```css
.paragraph.selected {
  background: rgba(0, 122, 255, 0.1);
  border-radius: 3px;
}

/* é€‰ä¸­å¤šä¸ªæ®µè½æ—¶ */
.paragraph.multi-selected {
  background: rgba(0, 122, 255, 0.15);
  border-left: 3px solid #007AFF;
}
```

**é£ä¹¦è®¾è®¡**:
```css
.paragraph.selected {
  background: rgba(31, 136, 229, 0.08);
  border: 1px solid rgba(31, 136, 229, 0.4);
  border-radius: 4px;
}
```

**Notion è®¾è®¡**:
```css
.notion-block.selected {
  background: rgba(45, 170, 219, 0.3);
  box-shadow: rgb(45, 170, 219) 0px 0px 0px 1px inset;
}
```

---

## å ä½ç¬¦ç³»ç»Ÿ

### 3.1 å ä½ç¬¦ç±»å‹

#### ç±»å‹ A: é€šç”¨æç¤ºï¼ˆCraftï¼‰
```typescript
const placeholders = [
  "Start writing...",
  "Type '/' for commands",
  "What's on your mind?",
  "Begin typing to create"
];

// éšæœºæˆ–æŒ‰ä¸Šä¸‹æ–‡é€‰æ‹©
```

#### ç±»å‹ B: åŠŸèƒ½å¼•å¯¼ï¼ˆé£ä¹¦ï¼‰
```typescript
const placeholders = {
  default: "è¾“å…¥æ–‡å­—",
  withSlash: "æŒ‰ä¸‹ '/' æ’å…¥å—",
  withAI: "è¾“å…¥ '@AI' å”¤èµ·åŠ©æ‰‹",
  afterHeading: "æ¥ä¸‹æ¥å†™ä»€ä¹ˆï¼Ÿ"
};
```

#### ç±»å‹ C: AIé›†æˆï¼ˆNotionï¼‰
```typescript
const placeholders = {
  default: "Press 'space' for AI, '/' for commands...",
  afterImage: "Add a caption...",
  inTable: "Type or paste content",
  inCode: "Write some code..."
};
```

---

### 3.2 å ä½ç¬¦æ˜¾ç¤ºé€»è¾‘

```typescript
interface PlaceholderConfig {
  show: boolean;
  text: string;
  context?: 'default' | 'after-media' | 'in-list' | 'in-table';
}

function getPlaceholder(editor: Editor, blockType: string): PlaceholderConfig {
  const isEmpty = editor.isEmpty;
  const isFocused = editor.isFocused;
  const previousBlock = editor.getPreviousBlock();
  
  // è§„åˆ™1: éç©ºä¸æ˜¾ç¤º
  if (!isEmpty) {
    return { show: false, text: '' };
  }
  
  // è§„åˆ™2: æ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©
  if (previousBlock?.type === 'image') {
    return { 
      show: true, 
      text: 'Add a caption...',
      context: 'after-media'
    };
  }
  
  // è§„åˆ™3: ç„¦ç‚¹çŠ¶æ€ï¼ˆCraft å’Œ Notion ä¿ç•™ï¼Œé£ä¹¦ç§»é™¤ï¼‰
  const showOnFocus = ['craft', 'notion'].includes(platform);
  if (isFocused && !showOnFocus) {
    return { show: false, text: '' };
  }
  
  // è§„åˆ™4: é»˜è®¤å ä½ç¬¦
  return {
    show: true,
    text: "è¾“å…¥ '/' æ‰“å¼€å‘½ä»¤èœå•...",
    context: 'default'
  };
}
```

---

### 3.3 å ä½ç¬¦åŠ¨ç”»

**Craft åŠ¨ç”»**:
```css
.placeholder {
  opacity: 0.5;
  transition: opacity 200ms ease-out;
  pointer-events: none;
}

.paragraph:focus .placeholder {
  opacity: 0.3;  /* ç„¦ç‚¹æ—¶å˜æ·¡ä½†ä¸æ¶ˆå¤± */
}

.paragraph.has-content .placeholder {
  opacity: 0;
  transform: scale(0.98);
}
```

**é£ä¹¦åŠ¨ç”»**:
```css
.placeholder {
  opacity: 0.4;
  transition: opacity 150ms linear;
}

.paragraph:focus .placeholder {
  opacity: 0;  /* ç„¦ç‚¹æ—¶ç«‹å³æ¶ˆå¤± */
}
```

**Notion åŠ¨ç”»**:
```css
.placeholder {
  opacity: 0.375;
  transition: opacity 100ms ease-in;
}

/* è¾“å…¥æ—¶æ¸éš */
.paragraph.typing .placeholder {
  opacity: 0;
  transition: opacity 50ms ease-out;
}
```

---

## å¿«æ·é”®ç³»ç»Ÿ

### 4.1 æ®µè½å¯¼èˆªå¿«æ·é”®

#### Craft å¿«æ·é”®
```typescript
const craftShortcuts = {
  // æ®µè½å¯¼èˆª
  'Cmd/Ctrl + Up': 'ç§»åŠ¨åˆ°ä¸Šä¸€æ®µ',
  'Cmd/Ctrl + Down': 'ç§»åŠ¨åˆ°ä¸‹ä¸€æ®µ',
  'Cmd/Ctrl + Home': 'ç§»åŠ¨åˆ°æ–‡æ¡£å¼€å¤´',
  'Cmd/Ctrl + End': 'ç§»åŠ¨åˆ°æ–‡æ¡£ç»“å°¾',
  
  // æ®µè½æ“ä½œ
  'Cmd/Ctrl + Enter': 'åœ¨ä¸‹æ–¹æ’å…¥æ®µè½',
  'Cmd/Ctrl + Shift + Enter': 'åœ¨ä¸Šæ–¹æ’å…¥æ®µè½',
  'Cmd/Ctrl + Shift + D': 'å¤åˆ¶å½“å‰æ®µè½',
  'Cmd/Ctrl + Shift + K': 'åˆ é™¤å½“å‰æ®µè½',
  
  // ç¼©è¿›
  'Tab': 'å¢åŠ ç¼©è¿›',
  'Shift + Tab': 'å‡å°‘ç¼©è¿›',
  
  // é€‰æ‹©
  'Cmd/Ctrl + A': 'å…¨é€‰æ®µè½ï¼ˆè¿ç»­æŒ‰ä¸¤æ¬¡å…¨é€‰æ–‡æ¡£ï¼‰',
  'Shift + Up/Down': 'æ‰©å±•é€‰æ‹©',
  'Esc': 'å–æ¶ˆé€‰æ‹©/é€€å‡ºç¼–è¾‘'
};
```

#### é£ä¹¦å¿«æ·é”®
```typescript
const feishuShortcuts = {
  // æ®µè½å¯¼èˆª
  'Ctrl/Cmd + Up': 'å…‰æ ‡ç§»è‡³æ®µé¦–',
  'Ctrl/Cmd + Down': 'å…‰æ ‡ç§»è‡³æ®µå°¾',
  
  // æ®µè½æ“ä½œ
  'Enter': 'æ–°å»ºæ®µè½',
  'Shift + Enter': 'æ®µå†…æ¢è¡Œ',
  'Ctrl/Cmd + Enter': 'åœ¨å½“å‰æ®µè½åæ’å…¥æ–°æ®µè½',
  'Ctrl/Cmd + D': 'å¤åˆ¶å½“å‰è¡Œ',
  'Ctrl/Cmd + Shift + K': 'åˆ é™¤å½“å‰è¡Œ',
  
  // æ ¼å¼åŒ–
  'Ctrl/Cmd + B': 'åŠ ç²—',
  'Ctrl/Cmd + I': 'æ–œä½“',
  'Ctrl/Cmd + U': 'ä¸‹åˆ’çº¿',
  'Ctrl/Cmd + Shift + X': 'åˆ é™¤çº¿',
  
  // ç¼©è¿›
  'Tab': 'å¢åŠ ç¼©è¿›',
  'Shift + Tab': 'å‡å°‘ç¼©è¿›',
  
  // é€‰æ‹©
  'Ctrl/Cmd + A': 'å…¨é€‰',
  'Esc': 'å–æ¶ˆé€‰æ‹©'
};
```

#### Notion å¿«æ·é”®
```typescript
const notionShortcuts = {
  // å—æ“ä½œ
  'Esc': 'é€‰ä¸­å½“å‰å—',
  'Cmd/Ctrl + A': 'é€‰ä¸­å—å†…æ‰€æœ‰å†…å®¹',
  'Esc' + 'Cmd/Ctrl + A': 'é€‰ä¸­æ•´ä¸ªé¡µé¢',
  
  // å—å¯¼èˆª
  'Cmd/Ctrl + }': 'ä¸‹ä¸€ä¸ªå—',
  'Cmd/Ctrl + {': 'ä¸Šä¸€ä¸ªå—',
  
  // å—ç¼–è¾‘
  'Enter': 'ç¼–è¾‘é€‰ä¸­çš„å—',
  'Cmd/Ctrl + D': 'å¤åˆ¶å—',
  'Cmd/Ctrl + Shift + Up/Down': 'ç§»åŠ¨å—',
  'Backspace': 'åˆ é™¤ç©ºå—',
  
  // è½¬æ¢å—ç±»å‹
  'Cmd/Ctrl + Shift + 0': 'è½¬ä¸ºæ­£æ–‡',
  'Cmd/Ctrl + Shift + 1-6': 'è½¬ä¸ºæ ‡é¢˜1-6',
  'Cmd/Ctrl + Shift + 7': 'è½¬ä¸ºåˆ—è¡¨',
  'Cmd/Ctrl + Shift + 8': 'è½¬ä¸ºæ— åºåˆ—è¡¨',
  'Cmd/Ctrl + Shift + 9': 'è½¬ä¸ºå¾…åŠ',
  
  // ç¼©è¿›
  'Tab': 'ç¼©è¿›',
  'Shift + Tab': 'åç¼©è¿›',
  
  // å†…å®¹ç¼–è¾‘
  'Cmd/Ctrl + B': 'ç²—ä½“',
  'Cmd/Ctrl + I': 'æ–œä½“',
  'Cmd/Ctrl + U': 'ä¸‹åˆ’çº¿',
  'Cmd/Ctrl + Shift + S': 'åˆ é™¤çº¿',
  'Cmd/Ctrl + K': 'åˆ›å»ºé“¾æ¥',
  'Cmd/Ctrl + E': 'è¡Œå†…ä»£ç '
};
```

---

### 4.2 å¿«æ·é”®å†²çªå¤„ç†

#### ä¼˜å…ˆçº§è§„åˆ™
```typescript
const shortcutPriority = {
  // 1. æµè§ˆå™¨é»˜è®¤å¿«æ·é”®ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œä¸å¯è¦†ç›–ï¼‰
  browser: [
    'Cmd/Ctrl + R',  // åˆ·æ–°
    'Cmd/Ctrl + W',  // å…³é—­æ ‡ç­¾
    'Cmd/Ctrl + T',  // æ–°æ ‡ç­¾
    'Cmd/Ctrl + N'   // æ–°çª—å£
  ],
  
  // 2. ç³»ç»Ÿçº§å¿«æ·é”®ï¼ˆæ¬¡é«˜ï¼Œä¸å»ºè®®è¦†ç›–ï¼‰
  system: [
    'Cmd/Ctrl + C',  // å¤åˆ¶
    'Cmd/Ctrl + V',  // ç²˜è´´
    'Cmd/Ctrl + X',  // å‰ªåˆ‡
    'Cmd/Ctrl + Z',  // æ’¤é”€
    'Cmd/Ctrl + Shift + Z'  // é‡åš
  ],
  
  // 3. åº”ç”¨çº§å¿«æ·é”®ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
  application: [
    'Cmd/Ctrl + /',  // æ‰“å¼€å‘½ä»¤èœå•
    'Cmd/Ctrl + K',  // é“¾æ¥
    'Cmd/Ctrl + Shift + K'  // åˆ é™¤è¡Œ
  ]
};
```

---

## äº¤äº’è¡Œä¸º

### 5.1 ç‚¹å‡»è¡Œä¸º

#### å•å‡»ï¼ˆClickï¼‰
```
åœºæ™¯: ç”¨æˆ·å•å‡»ç©ºç™½æ®µè½
è¡Œä¸º:
1. å…‰æ ‡å®šä½åˆ°æ®µè½å¼€å¤´
2. æ˜¾ç¤ºç„¦ç‚¹è¾¹æ¡†ï¼ˆå·¦ä¾§è“æ¡ï¼‰
3. å ä½ç¬¦æ¸éšï¼ˆCraftä¿ç•™ï¼Œé£ä¹¦ç§»é™¤ï¼‰
4. è§¦å‘ focus äº‹ä»¶
```

#### åŒå‡»ï¼ˆDouble Clickï¼‰
```
åœºæ™¯: ç”¨æˆ·åŒå‡»æ®µè½ä¸­çš„å•è¯
è¡Œä¸º:
1. é€‰ä¸­å½“å‰å•è¯
2. æ˜¾ç¤ºæµ®åŠ¨å·¥å…·æ 
3. æ®µè½è¿›å…¥é€‰ä¸­çŠ¶æ€
```

#### ä¸‰å‡»ï¼ˆTriple Clickï¼‰
```
åœºæ™¯: ç”¨æˆ·ä¸‰å‡»æ®µè½
è¡Œä¸º:
1. é€‰ä¸­æ•´ä¸ªæ®µè½
2. æ˜¾ç¤ºæµ®åŠ¨å·¥å…·æ 
3. å¯æ‹–æ‹½ç§»åŠ¨æ®µè½
```

---

### 5.2 é”®ç›˜è¡Œä¸º

#### Enter é”®

**Craft å¤„ç†**:
```typescript
function handleEnter(event: KeyboardEvent) {
  const { editor, selection } = event;
  
  // 1. åœ¨æ®µå°¾æŒ‰Enter - åˆ›å»ºæ–°æ®µè½
  if (selection.isAtEnd) {
    event.preventDefault();
    editor.commands.createParagraphAfter();
    return;
  }
  
  // 2. åœ¨æ®µä¸­æŒ‰Enter - åˆ†å‰²æ®µè½
  if (selection.isInMiddle) {
    event.preventDefault();
    editor.commands.splitParagraph();
    return;
  }
  
  // 3. Shift + Enter - è½¯æ¢è¡Œ
  if (event.shiftKey) {
    event.preventDefault();
    editor.commands.insertLineBreak();
    return;
  }
}
```

**é£ä¹¦å¤„ç†**:
```typescript
function handleEnter(event: KeyboardEvent) {
  const { editor, block } = event;
  
  // 1. ç©ºæ®µè½æŒ‰Enter - è½¬ä¸ºæ™®é€šæ®µè½æˆ–é€€å‡ºåˆ—è¡¨
  if (block.isEmpty) {
    if (block.isInList) {
      editor.commands.exitList();
    } else {
      editor.commands.createNewParagraph();
    }
    return;
  }
  
  // 2. æœ‰å†…å®¹æŒ‰Enter - æ­£å¸¸æ¢è¡Œ
  editor.commands.insertParagraphAfter();
}
```

**Notion å¤„ç†**:
```typescript
function handleEnter(event: KeyboardEvent) {
  const { editor, block } = event;
  
  // 1. ç©ºå—æŒ‰Enter - è½¬ä¸ºæ™®é€šæ®µè½
  if (block.isEmpty && block.type !== 'paragraph') {
    editor.commands.turnIntoParagraph();
    return;
  }
  
  // 2. æ­£å¸¸æƒ…å†µ - åˆ›å»ºæ–°å—
  editor.commands.createBlockAfter(block.type);
}
```

---

#### Backspace é”®

**é€šç”¨å¤„ç†é€»è¾‘**:
```typescript
function handleBackspace(event: KeyboardEvent) {
  const { editor, selection, block } = event;
  
  // 1. å…‰æ ‡åœ¨æ®µé¦– + æ®µè½ä¸ºç©º - åˆ é™¤æ®µè½
  if (selection.isAtStart && block.isEmpty) {
    event.preventDefault();
    editor.commands.deleteBlock();
    return;
  }
  
  // 2. å…‰æ ‡åœ¨æ®µé¦– + æ®µè½æœ‰å†…å®¹ - åˆå¹¶åˆ°ä¸Šä¸€æ®µ
  if (selection.isAtStart && !block.isEmpty) {
    event.preventDefault();
    const previousBlock = editor.getPreviousBlock();
    if (previousBlock) {
      editor.commands.mergeWithPrevious();
    }
    return;
  }
  
  // 3. æ­£å¸¸åˆ é™¤å­—ç¬¦
  // è®©æµè§ˆå™¨é»˜è®¤å¤„ç†
}
```

---

### 5.3 æ‹–æ‹½è¡Œä¸º

#### æ‹–æ‹½æ‰‹æŸ„è®¾è®¡

**Craft**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‹®â‹® è¿™æ˜¯æ®µè½å†…å®¹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘
  6ä¸ªç‚¹çš„æ‰‹æŸ„ï¼Œæ‚¬åœæ—¶æ˜¾ç¤º
```

**é£ä¹¦**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ â è¿™æ˜¯æ®µè½å†…å®¹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘ â†‘
  ä¸‰æ¨ªçº¿ + ä¸‰ç‚¹èœå•
```

**Notion**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ââ è¿™æ˜¯æ®µè½å†…å®¹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘
  6ä¸ªç‚¹ï¼Œç‚¹å‡»æ˜¾ç¤ºèœå•
```

#### æ‹–æ‹½å®ç°

```typescript
interface DragState {
  isDragging: boolean;
  draggedBlock: Block | null;
  dropTarget: Block | null;
  dropPosition: 'before' | 'after' | 'inside';
}

function handleDragStart(event: DragEvent, block: Block) {
  // 1. è®¾ç½®æ‹–æ‹½æ•°æ®
  event.dataTransfer.effectAllowed = 'move';
  event.dataTransfer.setData('text/plain', block.id);
  
  // 2. æ·»åŠ æ‹–æ‹½æ ·å¼
  block.element.classList.add('dragging');
  
  // 3. åˆ›å»ºæ‹–æ‹½é¢„è§ˆ
  const preview = createDragPreview(block);
  event.dataTransfer.setDragImage(preview, 0, 0);
}

function handleDragOver(event: DragEvent, targetBlock: Block) {
  event.preventDefault();
  
  // è®¡ç®—æ’å…¥ä½ç½®
  const rect = targetBlock.element.getBoundingClientRect();
  const mouseY = event.clientY;
  const blockMiddle = rect.top + rect.height / 2;
  
  const dropPosition = mouseY < blockMiddle ? 'before' : 'after';
  
  // æ˜¾ç¤ºæ’å…¥çº¿
  showDropIndicator(targetBlock, dropPosition);
}

function handleDrop(event: DragEvent, targetBlock: Block) {
  event.preventDefault();
  
  const draggedId = event.dataTransfer.getData('text/plain');
  const draggedBlock = editor.getBlock(draggedId);
  
  if (dropPosition === 'before') {
    editor.commands.moveBefore(draggedBlock, targetBlock);
  } else {
    editor.commands.moveAfter(draggedBlock, targetBlock);
  }
  
  // æ¸…ç†
  hideDropIndicator();
  draggedBlock.element.classList.remove('dragging');
}
```

---

## å®Œæ•´å®ç°ä»£ç 

### 6.1 ä¼˜åŒ–åçš„æ®µè½ç»„ä»¶

```typescript
import React, { useState, useRef, useEffect } from 'react';
import { NodeViewProps, NodeViewContent } from '@tiptap/react';
import { motion, AnimatePresence } from 'framer-motion';
import { GripVertical, MoreHorizontal } from 'lucide-react';
import { BlockWrapper } from './BlockWrapper';

interface ParagraphState {
  isFocused: boolean;
  isHovered: boolean;
  isEmpty: boolean;
  isSelected: boolean;
  isDragging: boolean;
}

/**
 * å¢å¼ºç‰ˆæ®µè½å— NodeView
 * å®Œå…¨éµå¾ª Craft + é£ä¹¦ + Notion çš„æœ€ä½³å®è·µ
 */
export const EnhancedParagraphNodeView: React.FC<NodeViewProps> = ({ 
  node, 
  editor,
  selected,
  updateAttributes 
}) => {
  const [state, setState] = useState<ParagraphState>({
    isFocused: false,
    isHovered: false,
    isEmpty: node.textContent.length === 0,
    isSelected: selected,
    isDragging: false
  });

  const contentRef = useRef<HTMLParagraphElement>(null);

  // æ›´æ–°ç©ºçŠ¶æ€
  useEffect(() => {
    setState(prev => ({ 
      ...prev, 
      isEmpty: node.textContent.length === 0 
    }));
  }, [node.textContent]);

  // æ›´æ–°é€‰ä¸­çŠ¶æ€
  useEffect(() => {
    setState(prev => ({ ...prev, isSelected: selected }));
  }, [selected]);

  // å ä½ç¬¦æ–‡æœ¬ï¼ˆæ ¹æ®ä¸Šä¸‹æ–‡ï¼‰
  const getPlaceholder = (): string => {
    if (!state.isEmpty) return '';
    
    const prevNode = editor.$pos(editor.state.selection.from - 1).node();
    
    // å›¾ç‰‡åæç¤ºæ·»åŠ æè¿°
    if (prevNode?.type.name === 'image') {
      return 'Add a caption...';
    }
    
    // åˆ—è¡¨ä¸­çš„æç¤º
    if (editor.isActive('bulletList') || editor.isActive('orderedList')) {
      return 'List item';
    }
    
    // é»˜è®¤æç¤º
    return "è¾“å…¥ '/' æ‰“å¼€å‘½ä»¤èœå•...";
  };

  // è¾¹æ¡†æ ·å¼ï¼ˆæ ¹æ®çŠ¶æ€ï¼‰
  const getBorderStyle = () => {
    if (state.isSelected) {
      return {
        background: 'rgba(31, 136, 229, 0.08)',
        border: '1px solid rgba(31, 136, 229, 0.4)',
        boxShadow: '0 0 0 2px rgba(31, 136, 229, 0.1)'
      };
    }
    
    if (state.isFocused) {
      return {
        background: 'transparent',
        borderLeft: '3px solid #2383E2',
        paddingLeft: '1px'
      };
    }
    
    if (state.isHovered) {
      return {
        background: 'rgba(55, 53, 47, 0.03)',
        borderRadius: '4px'
      };
    }
    
    return {
      background: 'transparent'
    };
  };

  return (
    <BlockWrapper
      showHandle={state.isHovered || state.isSelected}
      onDragStart={() => setState(prev => ({ ...prev, isDragging: true }))}
      style={{
        ...getBorderStyle(),
        transition: 'all 150ms cubic-bezier(0.4, 0, 0.2, 1)',
        opacity: state.isDragging ? 0.4 : 1
      }}
    >
      {/* æ®µè½å†…å®¹ */}
      <NodeViewContent
        ref={contentRef}
        as="p"
        className="kanso-paragraph-enhanced"
        data-placeholder={state.isEmpty && !state.isFocused ? getPlaceholder() : undefined}
        onFocus={() => setState(prev => ({ ...prev, isFocused: true }))}
        onBlur={() => setState(prev => ({ ...prev, isFocused: false }))}
        onMouseEnter={() => setState(prev => ({ ...prev, isHovered: true }))}
        onMouseLeave={() => setState(prev => ({ ...prev, isHovered: false }))}
        style={{
          minHeight: '32px',
          padding: '3px 2px',
          lineHeight: 1.6,
          fontSize: '16px',
          color: '#1F2937',
          outline: 'none',
          position: 'relative',
          cursor: 'text'
        }}
      />

      {/* å¿«æ·æ“ä½œèœå•ï¼ˆé£ä¹¦é£æ ¼ï¼‰*/}
      <AnimatePresence>
        {state.isHovered && (
          <motion.button
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            exit={{ opacity: 0, scale: 0.9 }}
            transition={{ duration: 0.15 }}
            className="block-menu-button"
            style={{
              position: 'absolute',
              left: '-48px',
              top: '50%',
              transform: 'translateY(-50%)',
              width: '20px',
              height: '20px',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              borderRadius: '4px',
              background: 'white',
              border: '1px solid #E5E7EB',
              cursor: 'pointer',
              transition: 'all 150ms'
            }}
            onClick={() => {
              // æ‰“å¼€å—èœå•
              console.log('Open block menu');
            }}
          >
            <MoreHorizontal className="w-3 h-3 text-gray-500" />
          </motion.button>
        )}
      </AnimatePresence>
    </BlockWrapper>
  );
};
```

---

### 6.2 æ®µè½æ ·å¼ï¼ˆCSSï¼‰

```css
/* ===== å¢å¼ºç‰ˆæ®µè½æ ·å¼ ===== */

.kanso-paragraph-enhanced {
  position: relative;
  caret-color: #2383E2;  /* Notion è“ */
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* å ä½ç¬¦ */
.kanso-paragraph-enhanced:empty::before {
  content: attr(data-placeholder);
  position: absolute;
  left: 2px;
  top: 3px;
  color: #9CA3AF;
  font-size: 15px;
  font-weight: 400;
  opacity: 0.6;
  pointer-events: none;
  transition: opacity 150ms ease-out;
}

/* ç„¦ç‚¹æ—¶å ä½ç¬¦æ¸éšï¼ˆCraft é£æ ¼ï¼‰*/
.kanso-paragraph-enhanced:focus::before {
  opacity: 0.3;
}

/* é£ä¹¦é£æ ¼ï¼šç„¦ç‚¹æ—¶å®Œå…¨éšè— */
.kanso-paragraph-enhanced.feishu-style:focus::before {
  opacity: 0;
}

/* é€‰ä¸­æ–‡æœ¬æ—¶çš„é¢œè‰² */
.kanso-paragraph-enhanced::selection {
  background: rgba(45, 170, 219, 0.3);
  color: inherit;
}

/* æ‹–æ‹½æ—¶çš„æ ·å¼ */
.kanso-paragraph-enhanced.dragging {
  opacity: 0.4;
  cursor: grabbing !important;
}

/* æ’å…¥æŒ‡ç¤ºçº¿ */
.drop-indicator {
  position: absolute;
  left: 0;
  right: 0;
  height: 2px;
  background: #2383E2;
  border-radius: 1px;
  pointer-events: none;
  z-index: 10;
}

.drop-indicator::before {
  content: '';
  position: absolute;
  left: -4px;
  top: -3px;
  width: 8px;
  height: 8px;
  background: #2383E2;
  border-radius: 50%;
}

/* æš—é»‘æ¨¡å¼ */
@media (prefers-color-scheme: dark) {
  .kanso-paragraph-enhanced {
    color: #E2E8F0;
    caret-color: #60A5FA;
  }
  
  .kanso-paragraph-enhanced:empty::before {
    color: #64748B;
  }
  
  .kanso-paragraph-enhanced::selection {
    background: rgba(96, 165, 250, 0.3);
  }
}

/* å“åº”å¼ */
@media (max-width: 640px) {
  .kanso-paragraph-enhanced {
    font-size: 15px;
    line-height: 1.7;
  }
  
  .block-menu-button {
    display: none !important;  /* ç§»åŠ¨ç«¯éšè—èœå• */
  }
}

/* æ‰“å°æ ·å¼ */
@media print {
  .kanso-paragraph-enhanced:empty::before {
    display: none;
  }
  
  .block-menu-button {
    display: none !important;
  }
}
```

---

## ğŸ“Š è®¾è®¡å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | Craft | é£ä¹¦ | Notion |
|------|-------|------|--------|
| **é»˜è®¤è¾¹æ¡†** | æ—  | é€æ˜ 1px | æ—  |
| **ç„¦ç‚¹è¾¹æ¡†** | å·¦ä¾§ 2px è“æ¡ | å››å‘¨ 1px + å¤–å‘å…‰ | å·¦ä¾§ 3px è“æ¡ |
| **æ‚¬åœèƒŒæ™¯** | è¶…æµ…ç° | æµ…ç° | ä¸­ç­‰ç° |
| **å ä½ç¬¦ç„¦ç‚¹è¡Œä¸º** | å˜æ·¡ä¿ç•™ | å®Œå…¨éšè— | å˜æ·¡ä¿ç•™ |
| **æ‹–æ‹½æ‰‹æŸ„** | 6ç‚¹ï¼ˆç®€çº¦ï¼‰| ä¸‰æ¨ªçº¿+èœå• | 6ç‚¹ï¼ˆåŠŸèƒ½ï¼‰|
| **å¿«æ·é”®é£æ ¼** | Macé£æ ¼ | è·¨å¹³å° | å—å¯¼å‘ |
| **åŠ¨ç”»é€Ÿåº¦** | 200ms | 150ms | 100-200ms |

---

## âœ… å®æ–½å»ºè®®

### ä¼˜å…ˆçº§ P0ï¼ˆç«‹å³å®æ–½ï¼‰
1. âœ… ä¼˜åŒ–å ä½ç¬¦ç³»ç»Ÿï¼ˆä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼‰
2. âœ… å®ç°ç„¦ç‚¹è¾¹æ¡†ï¼ˆå·¦ä¾§è“æ¡ï¼‰
3. âœ… æ·»åŠ å¿«æ·é”®æ”¯æŒï¼ˆEnter/Backspaceï¼‰
4. âœ… æ”¹è¿›æ‚¬åœäº¤äº’

### ä¼˜å…ˆçº§ P1ï¼ˆæœ¬å‘¨ï¼‰
1. å®ç°æ‹–æ‹½é‡æ’
2. æ·»åŠ å—èœå•æŒ‰é’®
3. å®Œå–„é”®ç›˜å¯¼èˆª
4. ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½

### ä¼˜å…ˆçº§ P2ï¼ˆåç»­ï¼‰
1. AI é›†æˆæç¤º
2. å¤šç«¯åŒæ­¥ä¼˜åŒ–
3. æ— éšœç¢æ”¯æŒ
4. æ€§èƒ½ç›‘æ§

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-29  
**ä½œè€…**: Kanso Team  
**å‚è€ƒ**: Craft.do, é£ä¹¦æ–‡æ¡£, Notion
